<div *ngIf="loading" class="content-load">
  <br>
  <mat-spinner class="child-load"></mat-spinner>
  <br>
  <mat-label class="child-load"><strong>Cargando... </strong></mat-label>
</div>

<div class="pipeline white lined-primary">
        <div class="pipeline-header">
          <h5 class="pipeline-name">
              Control de Horas
          </h5> 
          <div class="pipeline-settings os-dropdown-trigger" *ngIf="this.desactivar">
            <button mat-raised-button type="button" class="btn-primary btn-save" align="right" (click)='saveHorasAll()'>
              <mat-icon>save</mat-icon> Guardar</button>
          </div>
        </div>
        <table>
          <tr>
            <td><mat-form-field style="font-size: small; width: 100%;" *ngIf="this.bloquear">
              <mat-label>Ingrese usuario </mat-label>
              <input name="usuario" matInput placeholder="Ingreso de usuario" value="{{this.usuario}}" width="50px" (change)="onChange($event)"
                oninput="this.value = this.value.toUpperCase()">          
            </mat-form-field></td>
            
            <td><mat-form-field hintLabel="Max 3 numeros" style="font-size: small; width: 100%;">
                <input formControlName="horasAsigActividadInput" type="number" step="1" matInput
                  #inputHoras maxlength="3" placeholder="Ingrese cantidad de dias" id="horas" (change)="onChangeFecha($event)" value="{{this.fechaInputSelect}}"
                  min="1" max="999" onPaste="return false" onKeyPress="if(this.value.length==3) return false;"
                   oninput="this.value = Math.trunc(this.value)">
                </mat-form-field></td>
            <td width=60%></td>
          </tr>
        </table>  


    <div class="example-container1 mat-elevation-z8">
    <mat-label class="titulo" >Proyecto(s)</mat-label>
    <table mat-table [dataSource]="proyectoIniciativas" matSort id="tableHorasProyecto">
      <ng-container matColumnDef="codigosvt">
        <th mat-header-cell *matHeaderCellDef width ="10%"> N째 SVT/TICKET </th>
        <td mat-cell *matCellDef="let tipo" id="{{tipo.iniciativa.idIniciativa}}"> {{tipo.iniciativa.codigoSVT}}
        </td>
      </ng-container>
      <!-- Name Column -->
      <ng-container matColumnDef="titulo">
        <th mat-header-cell *matHeaderCellDef> TITULO </th>
        <td mat-cell *matCellDef="let tipo"> {{tipo.iniciativa.titulo}} </td>
      </ng-container>
      <ng-container matColumnDef="fechainicio">
        <th mat-header-cell *matHeaderCellDef width ="8%"> FECHA INICIO </th>
        <td mat-cell *matCellDef="let tipo"> {{tipo.iniciativa.fechaInicio | date: 'dd/MM/yyyy'}} </td>
      </ng-container>
      <ng-container matColumnDef="fechafin">
        <th mat-header-cell *matHeaderCellDef width ="8%"> FECHA FIN </th>
        <td mat-cell *matCellDef="let tipo"> {{tipo.iniciativa.fechaFin | date: 'dd/MM/yyyy'}} </td>
      </ng-container>
      <ng-container matColumnDef="avance">
        <th mat-header-cell *matHeaderCellDef width ="6%"> AVANCE </th>
        <td mat-cell *matCellDef="let tipo"> {{tipo.avance}} </td>
      </ng-container>
      <ng-container matColumnDef="prioridad">
        <th mat-header-cell *matHeaderCellDef width ="7%"> PRIORIDAD </th>
        <td mat-cell *matCellDef="let tipo"> {{tipo.iniciativa.prioridad.descripcion}} </td>
      </ng-container>
      <ng-container [matColumnDef]="columnName" *ngFor="let columnName of columnasFechTabla; let i = index">
        <th mat-header-cell *matHeaderCellDef width ="5%">{{columnName}}</th>
        <ng-container>
          <td mat-cell *matCellDef="let element"><input #inputHoras type="number" step="1" min="1" max="14"
              onPaste="return false" onKeyPress="if(this.value.length==2) return false;"
              oninput="this.value = Math.trunc(this.value)" value="{{element.horasFecha[i]}}"
              style="text-align: center; width: 50px;" class="pointer"> </td>
        </ng-container>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="columnasTabla" class="encabezado"></tr>
      <tr mat-row *matRowDef="let row; columns: columnasTabla;"></tr>
    </table> 

    <mat-label class="titulo">Mantenimiento(s)</mat-label>
    <table mat-table [dataSource]="mantenimientoIniciativas" matSort id="tableHorasMantenimiento">
      <ng-container matColumnDef="codigosvt">
        <th mat-header-cell *matHeaderCellDef width ="10%"> N째 SVT/TICKET </th>
        <td mat-cell *matCellDef="let tipo" id="{{tipo.iniciativa.idIniciativa}}"> {{tipo.iniciativa.codigoSVT}}
        </td>
      </ng-container>
      <!-- Name Column -->
      <ng-container matColumnDef="titulo">
        <th mat-header-cell *matHeaderCellDef> TITULO </th>
        <td mat-cell *matCellDef="let tipo"> {{tipo.iniciativa.titulo}} </td>
      </ng-container>
      <ng-container matColumnDef="fechainicio">
        <th mat-header-cell *matHeaderCellDef width ="8%"> FECHA INICIO </th>
        <td mat-cell *matCellDef="let tipo"> {{tipo.iniciativa.fechaInicio | date: 'dd/MM/yyyy'}} </td>
      </ng-container>
      <ng-container matColumnDef="fechafin">
        <th mat-header-cell *matHeaderCellDef width ="8%"> FECHA FIN </th>
        <td mat-cell *matCellDef="let tipo"> {{tipo.iniciativa.fechaFin | date: 'dd/MM/yyyy'}} </td>
      </ng-container>
      <ng-container matColumnDef="avance">
        <th mat-header-cell *matHeaderCellDef width ="6%"> AVANCE </th>
        <td mat-cell *matCellDef="let tipo"> {{tipo.avance}} </td>
      </ng-container>
      <ng-container matColumnDef="prioridad">
        <th mat-header-cell *matHeaderCellDef width ="7%"> PRIORIDAD </th>
        <td mat-cell *matCellDef="let tipo"> {{tipo.iniciativa.prioridad.descripcion}} </td>
      </ng-container>
      <ng-container [matColumnDef]="columnName" *ngFor="let columnName of columnasFechTabla; let i = index">
        <th mat-header-cell *matHeaderCellDef width ="5%">{{columnName}}</th>
        <ng-container>
          <td mat-cell *matCellDef="let element"><input #inputHoras type="number" step="1" min="1" max="14"
              onPaste="return false" onKeyPress="if(this.value.length==2) return false;"
              oninput="this.value = Math.trunc(this.value)" value="{{element.horasFecha[i]}}"
              style="text-align: center; width: 50px;" class="pointer"> </td>
        </ng-container>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="columnasTabla" class="encabezado"></tr>
      <tr mat-row *matRowDef="let row; columns: columnasTabla;"></tr>
    </table> 

    <mat-label class="titulo">Incidencia(s)</mat-label>
    <table mat-table [dataSource]="incidenciaIniciativas" matSort id="tableHorasIncidencias">
      <ng-container matColumnDef="codigosvt">
        <th mat-header-cell *matHeaderCellDef width ="10%"> N째 SVT/TICKET </th>
        <td mat-cell *matCellDef="let tipo" id="{{tipo.iniciativa.idIniciativa}}"> {{tipo.iniciativa.codigoSVT}}
        </td>
      </ng-container>
      <!-- Name Column -->
      <ng-container matColumnDef="titulo">
        <th mat-header-cell *matHeaderCellDef> TITULO </th>
        <td mat-cell *matCellDef="let tipo"> {{tipo.iniciativa.titulo}} </td>
      </ng-container>
      <ng-container matColumnDef="fechainicio">
        <th mat-header-cell *matHeaderCellDef width ="8%"> FECHA INICIO </th>
        <td mat-cell *matCellDef="let tipo"> {{tipo.iniciativa.fechaInicio | date: 'dd/MM/yyyy'}} </td>
      </ng-container>
      <ng-container matColumnDef="fechafin">
        <th mat-header-cell *matHeaderCellDef width ="8%"> FECHA FIN </th>
        <td mat-cell *matCellDef="let tipo"> {{tipo.iniciativa.fechaFin | date: 'dd/MM/yyyy'}} </td>
      </ng-container>
      <ng-container matColumnDef="avance">
        <th mat-header-cell *matHeaderCellDef width ="6%"> AVANCE </th>
        <td mat-cell *matCellDef="let tipo"> {{tipo.avance}} </td>
      </ng-container>
      <ng-container matColumnDef="prioridad">
        <th mat-header-cell *matHeaderCellDef width ="7%"> PRIORIDAD </th>
        <td mat-cell *matCellDef="let tipo"> {{tipo.iniciativa.prioridad.descripcion}} </td>
      </ng-container>
      <ng-container [matColumnDef]="columnName" *ngFor="let columnName of columnasFechTabla; let i = index">
        <th mat-header-cell *matHeaderCellDef width ="5%">{{columnName}}</th>
        <ng-container>
          <td mat-cell *matCellDef="let element"><input #inputHoras type="number" step="1" min="1" max="14"
              onPaste="return false" onKeyPress="if(this.value.length==2) return false;"
              oninput="this.value = Math.trunc(this.value)" value="{{element.horasFecha[i]}}"
              style="text-align: center; width: 50px;" class="pointer"> </td>
        </ng-container>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="columnasTabla" class="encabezado"></tr>
      <tr mat-row *matRowDef="let row; columns: columnasTabla;"></tr>
    </table> 

    <mat-label class="titulo">Soporte(s)</mat-label>
    <table mat-table [dataSource]="soporteIniciativas" matSort id="tableHorasSoporte">
      <ng-container matColumnDef="codigosvt">
        <th mat-header-cell *matHeaderCellDef width ="10%"> N째 SVT/TICKET </th>
        <td mat-cell *matCellDef="let tipo" id="{{tipo.iniciativa.idIniciativa}}"> {{tipo.iniciativa.codigoSVT}}
        </td>
      </ng-container>
      <!-- Name Column -->
      <ng-container matColumnDef="titulo">
        <th mat-header-cell *matHeaderCellDef> TITULO </th>
        <td mat-cell *matCellDef="let tipo"> {{tipo.iniciativa.titulo}} </td>
      </ng-container>
      <ng-container matColumnDef="fechainicio">
        <th mat-header-cell *matHeaderCellDef width ="8%"> FECHA INICIO </th>
        <td mat-cell *matCellDef="let tipo"> {{tipo.iniciativa.fechaInicio | date: 'dd/MM/yyyy'}} </td>
      </ng-container>
      <ng-container matColumnDef="fechafin">
        <th mat-header-cell *matHeaderCellDef width ="8%"> FECHA FIN </th>
        <td mat-cell *matCellDef="let tipo"> {{tipo.iniciativa.fechaFin | date: 'dd/MM/yyyy'}} </td>
      </ng-container>
      <ng-container matColumnDef="avance">
        <th mat-header-cell *matHeaderCellDef width ="6%"> AVANCE </th>
        <td mat-cell *matCellDef="let tipo"> {{tipo.avance}} </td>
      </ng-container>
      <ng-container matColumnDef="prioridad">
        <th mat-header-cell *matHeaderCellDef width ="7%"> PRIORIDAD </th>
        <td mat-cell *matCellDef="let tipo"> {{tipo.iniciativa.prioridad.descripcion}} </td>
      </ng-container>
      <ng-container [matColumnDef]="columnName" *ngFor="let columnName of columnasFechTabla; let i = index">
        <th mat-header-cell *matHeaderCellDef width ="5%">{{columnName}}</th>
        <ng-container>
          <td mat-cell *matCellDef="let element"><input #inputHoras type="number" step="1" min="1" max="14"
              onPaste="return false" onKeyPress="if(this.value.length==2) return false;"
              oninput="this.value = Math.trunc(this.value)" value="{{element.horasFecha[i]}}"
              style="text-align: center; width: 50px;" class="pointer"> </td>
        </ng-container>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="columnasTabla" class="encabezado"></tr>
      <tr mat-row *matRowDef="let row; columns: columnasTabla;"></tr>
    </table>
    
    <mat-label class="titulo">Esfuerzo Continuo(s)</mat-label>
    <table mat-table [dataSource]="esfuerzoIniciativas" matSort id="tableHorasEsfuerzo">
      <ng-container matColumnDef="codigosvt">
        <th mat-header-cell *matHeaderCellDef width ="10%"> ITEM </th>
        <td mat-cell *matCellDef="let tipo" id="{{tipo.iniciativa.idIniciativa}}"> {{tipo.iniciativa.codigoSVT}}
        </td>
      </ng-container>
      <!-- Name Column -->
      <ng-container matColumnDef="titulo">
        <th mat-header-cell *matHeaderCellDef> TITULO </th>
        <td mat-cell *matCellDef="let tipo"> {{tipo.iniciativa.titulo}} </td>
      </ng-container>
      <ng-container matColumnDef="fechainicio">
        <th mat-header-cell *matHeaderCellDef width ="8%"> FECHA INICIO </th>
        <td mat-cell *matCellDef="let tipo"> {{tipo.iniciativa.fechaInicio | date: 'dd/MM/yyyy'}} </td>
      </ng-container>
      <ng-container matColumnDef="fechafin">
        <th mat-header-cell *matHeaderCellDef width ="8%"> FECHA FIN </th>
        <td mat-cell *matCellDef="let tipo"> {{tipo.iniciativa.fechaFin | date: 'dd/MM/yyyy'}} </td>
      </ng-container>
      <ng-container matColumnDef="avance">
        <th mat-header-cell *matHeaderCellDef width ="6%"> AVANCE </th>
        <td mat-cell *matCellDef="let tipo"> {{tipo.avance}} </td>
      </ng-container>
      <ng-container matColumnDef="prioridad">
        <th mat-header-cell *matHeaderCellDef width ="7%"> PRIORIDAD </th>
        <td mat-cell *matCellDef="let tipo"> {{tipo.iniciativa.prioridad.descripcion}} </td>
      </ng-container>
      <ng-container [matColumnDef]="columnName" *ngFor="let columnName of columnasFechTabla; let i = index">
        <th mat-header-cell *matHeaderCellDef width ="5%">{{columnName}}</th>
        <ng-container>
          <td mat-cell *matCellDef="let element"><input #inputHoras type="number" step="1" min="1" max="14"
              onPaste="return false" onKeyPress="if(this.value.length==2) return false;"
              oninput="this.value = Math.trunc(this.value)" value="{{element.horasFecha[i]}}"
              style="text-align: center; width: 50px;" class="pointer"> </td>
        </ng-container>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="columnasTabla" class="encabezado"></tr>
      <tr mat-row *matRowDef="let row; columns: columnasTabla;"></tr>
    </table> 
    <br>
    
  </div>
</div>